---
layout: post
title: Leslie Matrices, part 1
subtitle: 
---

### Of Life, Death and Linear Algebra

In this post, we explore a family of population growth models based on linear algebra.

![_config.yml]({{ site.baseurl }}/images/leslie_illustration.png)

The basic idea is to structure a population's demographics by age, grouping individuals of a similar age. This is then encoded in a vector $N(t)$. To give a concrete example, let's consider the case of a human population. We focus on the **female population** for reasons that will become clearer below. We divide this population by age group.

For simplicity, let's create three age groups:
* **Group 1:** Ages 0-14 (Children)
* **Group 2:** Ages 15-49 (Reproductive years)
* **Group 3:** Ages 50+ (Post-reproductive years)

The number of females in each group at a given time $t$ can be represented by a column vector, which we'll call the **population vector** $N(t)$:

$$
N(t) = \begin{pmatrix} n_1(t) \\ n_2(t) \\ n_3(t) \end{pmatrix}
$$

where $n_i(t)$ is the number of females in age group $i$ at time $t$. Our goal is to predict the population vector at the next time step, $N(t+1)$. To do this, we need to understand two key demographic processes: **survival** and **reproduction**.

---

## Building the Leslie Matrix

The magic happens when we encode the rates of survival and reproduction into a special matrix called the **Leslie Matrix**, denoted by $L$. This matrix allows us to project the population into the future with a simple matrix-vector multiplication:

$$
N(t+1) = L \cdot N(t)
$$

The Leslie matrix is constructed from two main components:

### 1. Fecundity Rates ($f_i$) 

**Fecundity** is the average number of female offspring born to a female in a particular age group during one time step. This is why we focus only on the female population; they are the ones giving birth.

* $f_1$: Average offspring per female in group 1 (ages 0-14). This is typically very low or zero.
* $f_2$: Average offspring per female in group 2 (ages 15-49). This will be the highest value.
* $f_3$: Average offspring per female in group 3 (ages 50+). This is zero.

These fecundity rates form the **first row** of the Leslie matrix because new births contribute only to the youngest age group, $n_1$.

### 2. Survival Rates ($s_i$) 

**Survival rate** is the probability that an individual in age group $i$ will survive to the next age group, $i+1$, in the next time step.

* $s_1$: The probability of a female in group 1 (0-14) surviving to enter group 2 (15-49) in the next time period.
* $s_2$: The probability of a female in group 2 (15-49) surviving to enter group 3 (50+) in the next time period.

Note that there is no $s_3$, as group 3 is our final age group in this model. These survival rates are placed on the **sub-diagonal** of the Leslie matrix, as they represent the transition from one age group to the next.

Putting it all together, the Leslie matrix $L$ for our three-group model looks like this:

$$
L = \begin{pmatrix} f_1 & f_2 & f_3 \\ s_1 & 0 & 0 \\ 0 & s_2 & 0 \end{pmatrix}
$$

---

## A Concrete Example

Let's use some hypothetical numbers to see it in action. Suppose we have the following rates for a 15-year time step:

* $f_1 = 0.1$ (some births from late teens)
* $f_2 = 1.2$ (peak reproductive years)
* $f_3 = 0.0$ (no reproduction)
* $s_1 = 0.98$ (98% survive from group 1 to 2)
* $s_2 = 0.85$ (85% survive from group 2 to 3)

Our Leslie matrix is:

$$
L = \begin{pmatrix} 0.1 & 1.2 & 0 \\ 0.98 & 0 & 0 \\ 0 & 0.85 & 0 \end{pmatrix}
$$

Now, imagine our initial population at time $t=0$ is:

$$
N(0) = \begin{pmatrix} 1000 \\ 800 \\ 500 \end{pmatrix}
$$

We can predict the population at the next time step ($t=1$, i.e., 15 years later) by calculating $N(1) = L \cdot N(0)$:

$$
N(1) = \begin{pmatrix} 0.1 & 1.2 & 0 \\ 0.98 & 0 & 0 \\ 0 & 0.85 & 0 \end{pmatrix} \begin{pmatrix} 1000 \\ 800 \\ 500 \end{pmatrix} = \begin{pmatrix} (0.1 \cdot 1000) + (1.2 \cdot 800) + (0 \cdot 500) \\ (0.98 \cdot 1000) + (0 \cdot 800) + (0 \cdot 500) \\ (0 \cdot 1000) + (0.85 \cdot 800) + (0 \cdot 500) \end{pmatrix} = \begin{pmatrix} 100 + 960 \\ 980 \\ 680 \end{pmatrix} = \begin{pmatrix} 1060 \\ 980 \\ 680 \end{pmatrix}
$$

So, after 15 years, we predict there will be 1060 females in the 0-14 age group, 980 in the 15-49 group, and 680 in the 50+ group. We can repeat this process to project the population further into the future.

---

### What's Next?

This model is powerful because it does more than just step-by-step prediction. By analyzing the **eigenvalues and eigenvectors** of the Leslie matrix, we can uncover the long-term behavior of the population, such as its stable growth rate and its eventual age distribution. But that's a topic for **Part 2**!

<script
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
  type="text/javascript">
</script>